<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 680 340" fill="none">
  <style>
    .box { stroke: #3b82f6; stroke-width: 2; rx: 8; }
    .box-external { stroke: #64748b; stroke-width: 2; rx: 8; stroke-dasharray: 6 3; }
    .label { font-family: system-ui, -apple-system, sans-serif; font-size: 13px; text-anchor: middle; font-weight: 600; }
    .sublabel { font-family: system-ui, -apple-system, sans-serif; font-size: 11px; text-anchor: middle; }
    .arrow { stroke-width: 1.5; marker-end: url(#arrowhead); }
    .arrow-data { stroke: #3b82f6; stroke-width: 1.5; marker-end: url(#arrowhead-blue); }

    /* Dark mode (default) */
    .box { fill: #1e293b; }
    .box-external { fill: #0f172a; }
    .label { fill: #e2e8f0; }
    .sublabel { fill: #94a3b8; }
    .arrow { stroke: #475569; }
    #arrowhead polygon { fill: #475569; }

    /* Light mode */
    @media (prefers-color-scheme: light) {
      .box { fill: #f1f5f9; }
      .box-external { fill: #e2e8f0; }
      .label { fill: #1e293b; }
      .sublabel { fill: #475569; }
      .arrow { stroke: #94a3b8; }
      #arrowhead polygon { fill: #94a3b8; }
    }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#475569"/>
    </marker>
    <marker id="arrowhead-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#3b82f6"/>
    </marker>
  </defs>

  <!-- Row 1: Browser → Frontend → API Server -->
  <rect class="box" x="20" y="30" width="120" height="55"/>
  <text class="label" x="80" y="55">Browser</text>
  <text class="sublabel" x="80" y="70">Client</text>

  <line class="arrow" x1="140" y1="57" x2="210" y2="57"/>

  <rect class="box" x="220" y="30" width="140" height="55"/>
  <text class="label" x="290" y="55">Frontend</text>
  <text class="sublabel" x="290" y="70">(FastAPI)</text>

  <line class="arrow" x1="360" y1="57" x2="430" y2="57"/>

  <rect class="box" x="440" y="30" width="140" height="55"/>
  <text class="label" x="510" y="55">API Server</text>
  <text class="sublabel" x="510" y="70">(FastAPI)</text>

  <!-- API Server connections down -->
  <line class="arrow-data" x1="475" y1="85" x2="175" y2="150"/>
  <line class="arrow-data" x1="510" y1="85" x2="370" y2="150"/>
  <line class="arrow-data" x1="545" y1="85" x2="560" y2="150"/>

  <!-- Row 2: PostgreSQL, Valkey, ADSB-Sync -->
  <rect class="box" x="100" y="155" width="140" height="55"/>
  <text class="label" x="170" y="180">PostgreSQL</text>
  <text class="sublabel" x="170" y="195">Database</text>

  <rect class="box" x="300" y="155" width="140" height="55"/>
  <text class="label" x="370" y="180">Valkey</text>
  <text class="sublabel" x="370" y="195">Cache</text>

  <rect class="box" x="490" y="155" width="140" height="55"/>
  <text class="label" x="560" y="180">ADSB-Sync</text>
  <text class="sublabel" x="560" y="195">Service</text>

  <!-- ADSB-Sync → Valkey -->
  <line class="arrow-data" x1="490" y1="182" x2="440" y2="182"/>

  <!-- ADSB-Sync → OpenSky -->
  <line class="arrow" x1="560" y1="210" x2="560" y2="265"/>

  <!-- Row 3: OpenSky -->
  <rect class="box-external" x="490" y="270" width="140" height="50"/>
  <text class="label" x="560" y="293">OpenSky</text>
  <text class="sublabel" x="560" y="307">Network</text>
</svg>
